%
\begin{isabellebody}%
\setisabellecontext{Strings}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
\isanewline
\isanewline
%
\isamarkupsection{Strings%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Strings\isanewline
\ \ \isakeyword{imports}\ Ordinals\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
Alphanumeric characters are encoded as ordinals. Strings are ordered tuples of
characters.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Characters%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimML
%
\endisadelimML
%
\isatagML
\isacommand{ML}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
{\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}Use\ unary\ encoding\ for\ now{\isacharsemicolon}{\kern0pt}\ this\ can\ be\ swapped\ out\ for\ something\ more\isanewline
\ \ efficient\ later{\isachardot}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
fun\ von{\isacharunderscore}{\kern0pt}neumann\ i\ {\isacharequal}{\kern0pt}\ funpow\ i\ {\isacharparenleft}{\kern0pt}fn\ t\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlconst {\isasymopen}succ{\isasymclose}\ {\isachardollar}{\kern0pt}\ t{\isacharparenright}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isasymclose}\isanewline
\isanewline
val\ chars\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacharbrackleft}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{0}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{1}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{2}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{3}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{4}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{5}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{6}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{7}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{8}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{9}}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ {\isachardoublequote}{\kern0pt}a{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}b{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}c{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}d{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}e{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}f{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}g{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}h{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}i{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}j{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isachardoublequote}{\kern0pt}k{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}l{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}m{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ {\isachardoublequote}{\kern0pt}n{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}o{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}p{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}q{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}r{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}s{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}t{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}u{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}v{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}w{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}x{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}y{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}z{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ {\isachardoublequote}{\kern0pt}A{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}B{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}C{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}D{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}E{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}F{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}G{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}H{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}I{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}J{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}K{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}L{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}M{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ {\isachardoublequote}{\kern0pt}N{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}O{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}P{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}Q{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}R{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}S{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}T{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}U{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}V{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}W{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}X{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}Y{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}Z{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ {\isachardoublequote}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isachartilde}{\kern0pt}{\isachartilde}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}range\ von{\isacharunderscore}{\kern0pt}neumann\ {\isadigit{6}}{\isadigit{4}}\isanewline
{\isacartoucheclose}\isanewline
\isanewline
\isacommand{local{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ let\ val\ transforms\ {\isacharequal}{\kern0pt}\ chars\ {\isacharbar}{\kern0pt}{\isachargreater}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}fn\ {\isacharparenleft}{\kern0pt}char{\isacharcomma}{\kern0pt}\ tm{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ let\isanewline
\ \ \ \ \ \ val\ name\ {\isacharequal}{\kern0pt}\ {\isachardoublequote}{\kern0pt}char{\isacharprime}{\kern0pt}{\isachardoublequote}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ char\ {\isacharcircum}{\kern0pt}\ {\isachardoublequote}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardoublequote}{\kern0pt}\isanewline
\ \ \ \ \ \ val\ mx\ {\isacharequal}{\kern0pt}\ {\isachardoublequote}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardoublequote}{\kern0pt}\ {\isacharcircum}{\kern0pt}\ char\ {\isacharcircum}{\kern0pt}\ {\isachardoublequote}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardoublequote}{\kern0pt}\isanewline
\ \ \ \ in\isanewline
\ \ \ \ \ \ snd\ o\ Local{\isacharunderscore}{\kern0pt}Theory{\isachardot}{\kern0pt}define\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}Binding{\isachardot}{\kern0pt}qualified{\isacharunderscore}{\kern0pt}name\ name{\isacharcomma}{\kern0pt}\ Mixfix{\isachardot}{\kern0pt}mixfix\ mx{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}Binding{\isachardot}{\kern0pt}qualified{\isacharunderscore}{\kern0pt}name\ {\isacharparenleft}{\kern0pt}name\ {\isacharcircum}{\kern0pt}\ {\isachardoublequote}{\kern0pt}{\isacharunderscore}{\kern0pt}def{\isachardoublequote}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ tm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ end{\isacharparenright}{\kern0pt}\isanewline
\ \ in\ foldl{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}op\ o{\isacharparenright}{\kern0pt}\ transforms\ end\isanewline
{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Strings%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ string\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}set\ {\isasymRightarrow}\ set{\isacartoucheclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}string\ s\ {\isasymequiv}\ s{\isachardoublequoteclose}\ %
\isamarkupcmt{Wraps tuples of characters into strings.%
}%
\begin{isamarkuptext}%
Strings should be opaque to the type derivator.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{opaque}\isamarkupfalse%
\ {\isachardoublequoteopen}string{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{syntax}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}string{\isachardoublequoteclose}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacartoucheopen}pttrn\ {\isasymRightarrow}\ set{\isacartoucheclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isacharat}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{ML}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ fun\ term{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}char\ c\ {\isacharequal}{\kern0pt}\ case\ c\ of\isanewline
\ \ \ \ \ \ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{0}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{0}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{1}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{2}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{3}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{3}}{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{4}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{4}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{5}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{5}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{6}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{6}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{7}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{7}}{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{8}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{8}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isadigit{9}}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isadigit{9}}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}a{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}a{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}b{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}b{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}c{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}c{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}d{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}d{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}e{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}e{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}f{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}f{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}g{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}g{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}h{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}h{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}i{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}i{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}j{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}j{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}k{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}k{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}l{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}l{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}m{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}m{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}n{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}n{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}o{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}o{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}p{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}p{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}q{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}q{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}r{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}r{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}s{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}s{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}t{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}t{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}u{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}u{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}v{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}v{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}w{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}w{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}x{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}x{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}y{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}y{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}z{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}z{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}A{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}A{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}B{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}B{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}C{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}C{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}D{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}D{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}E{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}E{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}F{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}F{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}G{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}G{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}H{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}H{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}I{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}I{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}J{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}J{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}K{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}K{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}L{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}L{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}M{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}M{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}N{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}N{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}O{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}O{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}P{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}P{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}Q{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}Q{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}R{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}R{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}S{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}S{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}T{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}T{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}U{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}U{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}V{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}V{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}W{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}W{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}X{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}X{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}Y{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}Y{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}Z{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}Z{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharprime}{\kern0pt}{\isasymclose}\ {\isacharbar}{\kern0pt}\ {\isacharhash}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardoublequote}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlterm {\isasymopen}{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ raise\ Match\isanewline
\isanewline
\ \ fun\ pairify\ s\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}foldr{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}fn\ {\isacharparenleft}{\kern0pt}t{\isadigit{1}}{\isacharcomma}{\kern0pt}\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ \isactrlconst {\isasymopen}pair{\isasymclose}\ {\isachardollar}{\kern0pt}\ t{\isadigit{1}}\ {\isachardollar}{\kern0pt}\ t{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ term{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}char\ {\isacharparenleft}{\kern0pt}String{\isachardot}{\kern0pt}explode\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ fun\ str{\isacharunderscore}{\kern0pt}tr\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}c\ as\ Const\ {\isacharparenleft}{\kern0pt}\isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}constrain{\isasymclose}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t\ {\isachardollar}{\kern0pt}\ u{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ c\ {\isachardollar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isactrlconst {\isasymopen}string{\isasymclose}\ {\isachardollar}{\kern0pt}\ str{\isacharunderscore}{\kern0pt}tr\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ u\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ str{\isacharunderscore}{\kern0pt}tr\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}case\ t\ of\isanewline
\ \ \ \ \ \ \ \ \ \ Free\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ pairify\ s\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ Const\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isacharunderscore}{\kern0pt}idtdummy{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ error\ {\isachardoublequote}{\kern0pt}Cannot\ begin\ string\ with\ underscore{\isachardoublequote}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ Const\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ pairify\ s\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ raise\ TERM\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}str{\isacharunderscore}{\kern0pt}tr{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ str{\isacharunderscore}{\kern0pt}tr\ ts\ {\isacharequal}{\kern0pt}\ raise\ TERM\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}str{\isacharunderscore}{\kern0pt}tr{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ ts{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ fun\ tuple{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}string\ t\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ let\isanewline
\ \ \ \ \ \ fun\ char\ {\isacharparenleft}{\kern0pt}Const\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ base{\isacharunderscore}{\kern0pt}name\ {\isacharequal}{\kern0pt}\ nth\ {\isacharparenleft}{\kern0pt}space{\isacharunderscore}{\kern0pt}explode\ {\isachardoublequote}{\kern0pt}{\isachardot}{\kern0pt}{\isachardoublequote}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ nth{\isacharunderscore}{\kern0pt}string\ base{\isacharunderscore}{\kern0pt}name\ {\isadigit{5}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ end\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ char\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}\ raise\ Match\isanewline
\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ Josh{\isacharcolon}{\kern0pt}\ Some\ issue\ I\ can{\isacharprime}{\kern0pt}t\ figure\ out{\isacharcolon}{\kern0pt}\ at\ the\ stage\ at\ which\isanewline
\ \ \ \ \ \ \ \ print{\isacharunderscore}{\kern0pt}translation\ is\ called{\isacharcomma}{\kern0pt}\ the\ scope\ of\ {\isasymopen}pair{\isasymclose}\ hasn{\isacharprime}{\kern0pt}t\ been\ resolved\isanewline
\ \ \ \ \ \ \ \ fully{\isacharcomma}{\kern0pt}\ so\ using\ \isactrlconstUNDERSCOREname {\isasymopen}pair{\isasymclose}\ fails\ in\ the\ code\ below{\isachardot}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ fun\ tuple{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}string\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t\ {\isachardollar}{\kern0pt}\ ts{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}Underscore\ should\ be\ {\isasymopen}pair{\isasymclose}{\isacharbang}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ char\ t\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ tuple{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}string\ ts\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ tuple{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}string\ t\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}char\ t{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ in\isanewline
\ \ \ \ \ \ implode\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ case\ t\ of\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharasterisk}{\kern0pt}Underscore\ should\ be\ {\isasymopen}pair{\isasymclose}{\isacharbang}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isachardollar}{\kern0pt}\ t\ {\isachardollar}{\kern0pt}\ ts{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ char\ t\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ tuple{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}string\ ts\isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}char\ t{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ end\isanewline
\isanewline
\ \ fun\ str{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}string{\isasymclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ str{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}t{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Syntax{\isachardot}{\kern0pt}const\ \isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}string{\isasymclose}\ {\isachardollar}{\kern0pt}\ Syntax{\isachardot}{\kern0pt}free\ {\isacharparenleft}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}string\ t{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ str{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}\ ts\ {\isacharequal}{\kern0pt}\ raise\ TERM\ {\isacharparenleft}{\kern0pt}{\isachardoublequote}{\kern0pt}str{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}{\isachardoublequote}{\kern0pt}{\isacharcomma}{\kern0pt}\ ts{\isacharparenright}{\kern0pt}\isanewline
{\isacartoucheclose}\isanewline
\isanewline
\isacommand{parse{\isacharunderscore}{\kern0pt}translation}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\isactrlsyntaxUNDERSCOREconst {\isasymopen}{\isacharunderscore}{\kern0pt}string{\isasymclose}{\isacharcomma}{\kern0pt}\ K\ str{\isacharunderscore}{\kern0pt}tr{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacartoucheclose}\isanewline
\isacommand{print{\isacharunderscore}{\kern0pt}translation}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}\isactrlconstUNDERSCOREsyntax {\isasymopen}string{\isasymclose}{\isacharcomma}{\kern0pt}\ K\ str{\isacharunderscore}{\kern0pt}tr{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
\isanewline
%
\endisadelimML
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ char{\isacharunderscore}{\kern0pt}simps\ {\isacharequal}{\kern0pt}\isanewline
\ \ char{\isacharprime}{\kern0pt}{\isadigit{0}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{3}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{4}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{5}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{6}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}{\isadigit{7}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{8}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isadigit{9}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}a{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}b{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}c{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}d{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}e{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}g{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}h{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}i{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}j{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}k{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}l{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}m{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}n{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}o{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}p{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}q{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}r{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}s{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}t{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}u{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}w{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}x{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}y{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}z{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}A{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}B{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}C{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}D{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}E{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}F{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}G{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}H{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}I{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}J{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}K{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}L{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}M{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}N{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}O{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}P{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}Q{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}R{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}S{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}T{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ char{\isacharprime}{\kern0pt}U{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}V{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}W{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}X{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}Y{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}Z{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def\ char{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}def%
\begin{isamarkuptext}%
The following lemma is used to prove distinctness of non-identical strings.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ pair{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}succ{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlangle}a{\isacharcomma}{\kern0pt}\ b{\isasymrangle}\ {\isasymnoteq}\ succ\ n{\isachardoublequoteclose}\ %
\isamarkupcmt{Very encoding-dependent!%
}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ pair{\isacharunderscore}{\kern0pt}def\ succ{\isacharunderscore}{\kern0pt}def\isanewline
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\isanewline
\ \ \ \ {\isacharquery}{\kern0pt}pair\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharbraceright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\isanewline
\ \ \ \ asm{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}pair\ {\isacharequal}{\kern0pt}\ n\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}n{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\isanewline
\ \ \ \ {\isachardoublequoteopen}n\ {\isasymin}\ {\isacharquery}{\kern0pt}pair{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\isanewline
\ \ \ \ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ {\isasymor}\ n\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharcomma}{\kern0pt}\ b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\isanewline
\ \ \ \ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharquery}{\kern0pt}pair{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ asm{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ succ{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}pair\ {\isacharequal}{\kern0pt}\ pair{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}succ{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{String Disequality%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ False{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharequal}{\kern0pt}\ b\ {\isasymLongrightarrow}\ a\ {\isasymnoteq}\ b\ {\isasymLongrightarrow}\ False{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ string{\isacharunderscore}{\kern0pt}conj{\isacharunderscore}{\kern0pt}simp\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlbrakk}string\ a\ {\isasymnoteq}\ string\ b{\isacharsemicolon}{\kern0pt}\ P{\isasymrbrakk}\ {\isasymLongrightarrow}\ string\ a\ {\isasymnoteq}\ string\ b\ {\isasymand}\ P{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
%
\isadelimML
\isanewline
%
\endisadelimML
%
\isatagML
\isacommand{ML}\isamarkupfalse%
\ {\isacartoucheopen}\isanewline
\ \ fun\ string{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ let\isanewline
\ \ \ \ \ \ val\ char{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}word{\isacharunderscore}{\kern0pt}tac\ {\isacharequal}{\kern0pt}\ SUBGOAL\ {\isacharparenleft}{\kern0pt}fn\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ rewrite{\isacharunderscore}{\kern0pt}goal{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ char{\isacharunderscore}{\kern0pt}simps{\isacharbraceright}{\kern0pt}\ i\isanewline
\ \ \ \ \ \ \ \ THEN\ HEADGOAL\ {\isacharparenleft}{\kern0pt}eresolve{\isadigit{0}}{\isacharunderscore}{\kern0pt}tac\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ succ{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}pair\ pair{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}succ{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \ \ fun\ word{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\ i\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ let\isanewline
\ \ \ \ \ \ \ \ \ \ val\ char{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\ {\isacharequal}{\kern0pt}\ SUBGOAL\ {\isacharparenleft}{\kern0pt}fn\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ rewrite{\isacharunderscore}{\kern0pt}goal{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ char{\isacharunderscore}{\kern0pt}simps{\isacharbraceright}{\kern0pt}\ i\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ THEN\ REPEAT\ {\isacharparenleft}{\kern0pt}HEADGOAL\ {\isacharparenleft}{\kern0pt}dresolve{\isadigit{0}}{\isacharunderscore}{\kern0pt}tac\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ succ{\isacharunderscore}{\kern0pt}inj{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ THEN\ HEADGOAL\ {\isacharparenleft}{\kern0pt}eresolve{\isadigit{0}}{\isacharunderscore}{\kern0pt}tac\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ False{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}eq{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ THEN\ HEADGOAL\ {\isacharparenleft}{\kern0pt}resolve{\isadigit{0}}{\isacharunderscore}{\kern0pt}tac\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ succ{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}empty\ succ{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}empty{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ val\ first{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ TRY\ o\ dresolve{\isadigit{0}}{\isacharunderscore}{\kern0pt}tac\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ eq{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}left{\isacharbraceright}{\kern0pt}\ THEN{\isacharprime}{\kern0pt}\ char{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\isanewline
\ \ \ \ \ \ \ \ in\isanewline
\ \ \ \ \ \ \ \ \ \ REPEAT\ {\isacharparenleft}{\kern0pt}CHANGED\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}char{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}word{\isacharunderscore}{\kern0pt}tac\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ ORELSE{\isacharprime}{\kern0pt}\ first{\isacharunderscore}{\kern0pt}char{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ ORELSE{\isacharprime}{\kern0pt}\ dresolve{\isadigit{0}}{\isacharunderscore}{\kern0pt}tac\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ eq{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}right{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ end\isanewline
\ \ \ \ in\isanewline
\ \ \ \ \ \ resolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ notI{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ THEN{\isacharprime}{\kern0pt}\ rewrite{\isacharunderscore}{\kern0pt}goal{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ string{\isacharunderscore}{\kern0pt}def{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ THEN{\isacharprime}{\kern0pt}\ word{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\isanewline
\ \ \ \ end\isanewline
\isanewline
\ \ val\ string{\isacharunderscore}{\kern0pt}simp{\isacharunderscore}{\kern0pt}solver\ {\isacharequal}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}theory{\isacharunderscore}{\kern0pt}simpset\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ ctxt\ addSolver\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}solver\ {\isachardoublequote}{\kern0pt}distinguish\ strings{\isachardoublequote}{\kern0pt}\ string{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
{\isacartoucheclose}\isanewline
\isanewline
\isacommand{setup}\isamarkupfalse%
\ {\isacartoucheopen}string{\isacharunderscore}{\kern0pt}simp{\isacharunderscore}{\kern0pt}solver{\isacartoucheclose}\isanewline
\isanewline
\isacommand{method{\isacharunderscore}{\kern0pt}setup}\isamarkupfalse%
\ string{\isacharunderscore}{\kern0pt}ne\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacartoucheopen}Scan{\isachardot}{\kern0pt}succeed\ {\isacharparenleft}{\kern0pt}fn\ ctxt\ {\isacharequal}{\kern0pt}{\isachargreater}{\kern0pt}\ SIMPLE{\isacharunderscore}{\kern0pt}METHOD{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}TRY\ o\ eresolve{\isacharunderscore}{\kern0pt}tac\ ctxt\ {\isacharat}{\kern0pt}{\isacharbraceleft}{\kern0pt}thms\ False{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}eq{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ THEN{\isacharprime}{\kern0pt}\ string{\isacharunderscore}{\kern0pt}ne{\isacharunderscore}{\kern0pt}tac\ ctxt{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacartoucheclose}%
\endisatagML
{\isafoldML}%
%
\isadelimML
%
\endisadelimML
\isanewline
\isanewline
\isanewline
\isacommand{notepad}\isamarkupfalse%
\isanewline
\isakeyword{begin}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{have}\isamarkupfalse%
\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharat}{\kern0pt}Alex\ {\isasymnoteq}\ {\isacharat}{\kern0pt}Josh{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharat}{\kern0pt}abcd\ {\isasymnoteq}\ {\isacharat}{\kern0pt}asdf{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharat}{\kern0pt}abcd\ {\isasymnoteq}\ {\isacharat}{\kern0pt}asdf{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharat}{\kern0pt}abcdefg\ {\isasymnoteq}\ {\isacharat}{\kern0pt}asdfghj{\isachardoublequoteclose}\ \isakeyword{and}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharat}{\kern0pt}a{\isadigit{1}}{\isadigit{0}}\ {\isasymnoteq}\ {\isacharat}{\kern0pt}b{\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/github/Isabelle-Set/Isabelle_Set/Strings.thy%:%
%:%10=1%:%
%:%11=2%:%
%:%13=4%:%
%:%29=5%:%
%:%30=5%:%
%:%31=6%:%
%:%32=7%:%
%:%41=9%:%
%:%42=10%:%
%:%51=12%:%
%:%67=14%:%
%:%68=14%:%
%:%80=26%:%
%:%81=27%:%
%:%82=28%:%
%:%83=28%:%
%:%109=42%:%
%:%119=44%:%
%:%120=44%:%
%:%121=45%:%
%:%122=45%:%
%:%125=47%:%
%:%127=49%:%
%:%128=49%:%
%:%129=50%:%
%:%130=51%:%
%:%131=51%:%
%:%134=52%:%
%:%139=53%:%
%:%140=53%:%
%:%202=115%:%
%:%203=116%:%
%:%204=117%:%
%:%205=117%:%
%:%206=118%:%
%:%207=118%:%
%:%212=118%:%
%:%215=119%:%
%:%216=120%:%
%:%217=120%:%
%:%218=121%:%
%:%219=122%:%
%:%220=123%:%
%:%221=124%:%
%:%222=125%:%
%:%223=126%:%
%:%224=127%:%
%:%225=128%:%
%:%226=129%:%
%:%228=131%:%
%:%230=133%:%
%:%231=133%:%
%:%232=133%:%
%:%233=133%:%
%:%240=134%:%
%:%241=134%:%
%:%242=135%:%
%:%243=135%:%
%:%244=136%:%
%:%245=136%:%
%:%246=137%:%
%:%247=138%:%
%:%248=138%:%
%:%249=139%:%
%:%250=140%:%
%:%251=140%:%
%:%252=140%:%
%:%253=141%:%
%:%254=142%:%
%:%255=142%:%
%:%256=143%:%
%:%257=143%:%
%:%258=144%:%
%:%259=145%:%
%:%260=145%:%
%:%261=146%:%
%:%262=146%:%
%:%263=147%:%
%:%264=148%:%
%:%265=148%:%
%:%266=149%:%
%:%267=149%:%
%:%268=149%:%
%:%269=150%:%
%:%275=150%:%
%:%278=151%:%
%:%279=152%:%
%:%280=152%:%
%:%287=155%:%
%:%297=157%:%
%:%298=157%:%
%:%300=157%:%
%:%304=157%:%
%:%305=157%:%
%:%312=157%:%
%:%313=158%:%
%:%314=159%:%
%:%315=159%:%
%:%316=160%:%
%:%318=160%:%
%:%322=160%:%
%:%330=160%:%
%:%333=161%:%
%:%338=162%:%
%:%339=162%:%
%:%370=193%:%
%:%371=194%:%
%:%372=195%:%
%:%373=195%:%
%:%374=196%:%
%:%375=197%:%
%:%376=197%:%
%:%377=198%:%
%:%386=200%:%
%:%387=201%:%
%:%388=202%:%
%:%389=203%:%
%:%390=203%:%
%:%391=204%:%
%:%394=205%:%
%:%398=205%:%
%:%399=205%:%
%:%400=206%:%
%:%401=207%:%
%:%402=208%:%
%:%403=209%:%
%:%404=210%:%
%:%405=211%:%
%:%406=211%:%
%:%411=211%:%
%:%414=212%:%
%:%415=212%:%
%:%416=213%:%
%:%419=214%:%
%:%424=215%:%
