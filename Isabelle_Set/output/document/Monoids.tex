%
\begin{isabellebody}%
\setisabellecontext{Monoids}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
\isanewline
\isanewline
%
\isamarkupsection{Monoids%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Monoids\isanewline
\ \ \isakeyword{imports}\ Structures\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
An experiment with softly-typed, set-theoretic type classes.

We define monoids as a soft type class and experiment with how it interacts
with implicit arguments and type inference. Everything is done manually here;
most of it will be automated away in future work.%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
The monoid typeclass is defined using the standard soft type
infrastructure.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}typeclass{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Monoid\ A\ {\isasymequiv}\ Zero\ A\ {\isacharampersand}{\kern0pt}\ Add\ A\ {\isacharampersand}{\kern0pt}\isanewline
\ \ type\ {\isacharparenleft}{\kern0pt}{\isasymlambda}M{\isachardot}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isacharcolon}{\kern0pt}\ A{\isachardot}{\kern0pt}\ add\ M\ {\isacharparenleft}{\kern0pt}zero\ M{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x\ {\isasymand}\ add\ M\ x\ {\isacharparenleft}{\kern0pt}zero\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ y\ z\ {\isacharcolon}{\kern0pt}\ A{\isachardot}{\kern0pt}\ add\ M\ {\isacharparenleft}{\kern0pt}add\ M\ x\ y{\isacharparenright}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ add\ M\ x\ {\isacharparenleft}{\kern0pt}add\ M\ y\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
It would be really nice if this worked:%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
Instead we have to do this for now:%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ MonoidI{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Zero\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Add\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ add\ M\ {\isacharparenleft}{\kern0pt}zero\ M{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ add\ M\ x\ {\isacharparenleft}{\kern0pt}zero\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x\ y\ z{\isachardot}{\kern0pt}\ {\isasymlbrakk}x\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ y\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ z\ {\isacharcolon}{\kern0pt}\ A{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ add\ M\ {\isacharparenleft}{\kern0pt}add\ M\ x\ y{\isacharparenright}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ add\ M\ x\ {\isacharparenleft}{\kern0pt}add\ M\ y\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Monoid\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Monoid{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Int{\isacharunderscore}{\kern0pt}typeI\ has{\isacharunderscore}{\kern0pt}typeI{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The above theorem as well as the next ones should also be automatically
generated.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\isanewline
\ \ \isakeyword{shows}\ Monoid{\isacharunderscore}{\kern0pt}Zero\ {\isacharbrackleft}{\kern0pt}derive{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Monoid\ A\ {\isasymLongrightarrow}\ M\ {\isacharcolon}{\kern0pt}\ Zero\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Monoid{\isacharunderscore}{\kern0pt}Add\ {\isacharbrackleft}{\kern0pt}derive{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Monoid\ A\ {\isasymLongrightarrow}\ M\ {\isacharcolon}{\kern0pt}\ Add\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Monoid{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ M\ {\isacharcolon}{\kern0pt}\ Monoid\ A\ {\isasymLongrightarrow}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ add\ M\ {\isacharparenleft}{\kern0pt}zero\ M{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Monoid{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ M\ {\isacharcolon}{\kern0pt}\ Monoid\ A\ {\isasymLongrightarrow}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ add\ M\ x\ {\isacharparenleft}{\kern0pt}zero\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Monoid{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x\ y\ z{\isachardot}{\kern0pt}\ {\isasymlbrakk}M\ {\isacharcolon}{\kern0pt}\ Monoid\ A{\isacharsemicolon}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ y\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ z\ {\isacharcolon}{\kern0pt}\ A{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ add\ M\ {\isacharparenleft}{\kern0pt}add\ M\ x\ y{\isacharparenright}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ add\ M\ x\ {\isacharparenleft}{\kern0pt}add\ M\ y\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Monoid{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ {\isadigit{7}}\ {\isadigit{0}}\ dest{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}typeD{\isadigit{1}}\ Int{\isacharunderscore}{\kern0pt}typeD{\isadigit{2}}\ has{\isacharunderscore}{\kern0pt}typeD{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Direct sum%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
We develop the construction of direct sums of monoids by defining it as
the (disjoint) union of the zero and add structures.

We emulate automation that needs to be implemented in future work.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}Zero{\isacharunderscore}{\kern0pt}pair\ Z{\isadigit{1}}\ Z{\isadigit{2}}\ {\isasymequiv}\ object\ {\isacharbraceleft}{\kern0pt}{\isasymlangle}{\isacharat}{\kern0pt}zero{\isacharcomma}{\kern0pt}\ {\isasymlangle}zero\ Z{\isadigit{1}}{\isacharcomma}{\kern0pt}\ zero\ Z{\isadigit{2}}{\isasymrangle}{\isasymrangle}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Zero{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fields{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}object{\isacharunderscore}{\kern0pt}fields\ {\isacharparenleft}{\kern0pt}Zero{\isacharunderscore}{\kern0pt}pair\ Z{\isadigit{1}}\ Z{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharat}{\kern0pt}zero{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Zero{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Zero{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}Zero{\isacharunderscore}{\kern0pt}pair\ Z{\isadigit{1}}\ Z{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ zero\ {\isacharequal}{\kern0pt}\ {\isasymlangle}zero\ Z{\isadigit{1}}{\isacharcomma}{\kern0pt}\ zero\ Z{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Zero{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Zero{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}type\ {\isacharbrackleft}{\kern0pt}type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Zero{\isacharunderscore}{\kern0pt}pair{\isacharcolon}{\kern0pt}\ Zero\ A\ {\isasymRightarrow}\ Zero\ B\ {\isasymRightarrow}\ Zero\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}typeI{\isacharcomma}{\kern0pt}\ rule\ ZeroI{\isacharparenright}{\kern0pt}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}Add{\isacharunderscore}{\kern0pt}pair\ A\ B\ AA\ AB\ {\isasymequiv}\ object\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ {\isasymlangle}{\isacharat}{\kern0pt}add{\isacharcomma}{\kern0pt}\ {\isasymlambda}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}\ b{\isadigit{1}}{\isasymrangle}\ {\isasymlangle}a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ b{\isadigit{2}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlangle}add\ AA\ a{\isadigit{1}}\ a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ add\ AB\ b{\isadigit{1}}\ b{\isadigit{2}}{\isasymrangle}{\isasymrangle}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Add{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fields{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}object{\isacharunderscore}{\kern0pt}fields\ {\isacharparenleft}{\kern0pt}Add{\isacharunderscore}{\kern0pt}pair\ A\ B\ AA\ AB{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharat}{\kern0pt}add{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Add{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Add{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}Add{\isacharunderscore}{\kern0pt}pair\ A\ B\ AA\ AB{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ add\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isasymlambda}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}\ b{\isadigit{1}}{\isasymrangle}\ {\isasymlangle}a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ b{\isadigit{2}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlangle}add\ AA\ a{\isadigit{1}}\ a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ add\ AB\ b{\isadigit{1}}\ b{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Add{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Add{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}type\ {\isacharbrackleft}{\kern0pt}type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Add{\isacharunderscore}{\kern0pt}pair{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}\ Set{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcolon}{\kern0pt}\ Set{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ Add\ {\isacharparenleft}{\kern0pt}Element\ A{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ Add\ {\isacharparenleft}{\kern0pt}Element\ B{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isasymRightarrow}\ Add\ {\isacharparenleft}{\kern0pt}Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}typeI\ AddI{\isacharcomma}{\kern0pt}\ subst\ Add{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ A\ B\ AA\ AB\ \isacommand{assume}\isamarkupfalse%
\ h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}AA\ {\isacharcolon}{\kern0pt}\ Add\ {\isacharparenleft}{\kern0pt}Element\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}AB\ {\isacharcolon}{\kern0pt}\ Add\ {\isacharparenleft}{\kern0pt}Element\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}f\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}\ b{\isadigit{1}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlambda}{\isasymlangle}a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ b{\isadigit{2}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlangle}add\ AA\ a{\isadigit{1}}\ a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ add\ AB\ b{\isadigit{1}}\ b{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ h\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}f\ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}cs\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}cs\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ iff{\isacharcolon}{\kern0pt}\ Element{\isacharunderscore}{\kern0pt}dep{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}Dep{\isacharunderscore}{\kern0pt}Pair\isanewline
\ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ lambda{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}type\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}typeI{\isacharcomma}{\kern0pt}\ discharge{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}f\ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}s\ {\isacharparenleft}{\kern0pt}Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}s\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Dep{\isacharunderscore}{\kern0pt}Function{\isacharunderscore}{\kern0pt}covariant{\isacharunderscore}{\kern0pt}codom\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
TODO: In the future, there should be a command for object
composition/extension.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}Monoid{\isacharunderscore}{\kern0pt}pair\ A\ B\ MA\ MB\ {\isasymequiv}\ object\ {\isacharbraceleft}{\kern0pt}\isanewline
\ \ \ \ {\isasymlangle}{\isacharat}{\kern0pt}zero{\isacharcomma}{\kern0pt}\ {\isasymlangle}zero\ MA{\isacharcomma}{\kern0pt}\ zero\ MB{\isasymrangle}{\isasymrangle}{\isacharcomma}{\kern0pt}\isanewline
\ \ \ \ {\isasymlangle}{\isacharat}{\kern0pt}add{\isacharcomma}{\kern0pt}\ {\isasymlambda}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}\ b{\isadigit{1}}{\isasymrangle}\ {\isasymlangle}a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ b{\isadigit{2}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlangle}add\ MA\ a{\isadigit{1}}\ a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ add\ MB\ b{\isadigit{1}}\ b{\isadigit{2}}{\isasymrangle}{\isasymrangle}\isanewline
\ \ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Monoid{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}fields{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}object{\isacharunderscore}{\kern0pt}fields\ {\isacharparenleft}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}pair\ A\ B\ MA\ MB{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharat}{\kern0pt}zero{\isacharcomma}{\kern0pt}\ {\isacharat}{\kern0pt}add{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Monoid{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ Monoid{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}zero{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}pair\ A\ B\ MA\ MB{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ zero\ {\isacharequal}{\kern0pt}\ {\isasymlangle}zero\ MA{\isacharcomma}{\kern0pt}\ zero\ MB{\isasymrangle}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Monoid{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}pair\ A\ B\ MA\ MB{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ add\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isasymlambda}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}\ b{\isadigit{1}}{\isasymrangle}\ {\isasymlangle}a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ b{\isadigit{2}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlangle}add\ MA\ a{\isadigit{1}}\ a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ add\ MB\ b{\isadigit{1}}\ b{\isadigit{2}}{\isasymrangle}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Monoid{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The following proofs illustrate that reasoning with types is still very
pedestrian and needs better automated support.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ Monoid{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}type\ {\isacharbrackleft}{\kern0pt}type{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}Monoid{\isacharunderscore}{\kern0pt}pair\ {\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcolon}{\kern0pt}\ Set{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcolon}{\kern0pt}\ Set{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ Monoid\ {\isacharparenleft}{\kern0pt}Element\ A{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\isanewline
\ \ \ \ Monoid\ {\isacharparenleft}{\kern0pt}Element\ B{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ Monoid\ {\isacharparenleft}{\kern0pt}Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}typeI\ MonoidI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ A\ B\ MA\ MB\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}MA\ {\isacharcolon}{\kern0pt}\ Monoid\ {\isacharparenleft}{\kern0pt}Element\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}MB\ {\isacharcolon}{\kern0pt}\ Monoid\ {\isacharparenleft}{\kern0pt}Element\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Monoid{\isacharunderscore}{\kern0pt}pair\ A\ B\ MA\ MB{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}M\ {\isacharcolon}{\kern0pt}\ Zero\ {\isacharparenleft}{\kern0pt}Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ ZeroI{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ iff{\isacharcolon}{\kern0pt}\ Element{\isacharunderscore}{\kern0pt}dep{\isacharunderscore}{\kern0pt}pairs{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}Dep{\isacharunderscore}{\kern0pt}Pair{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}p{\isachardot}{\kern0pt}\ p\ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ p\ {\isacharcolon}{\kern0pt}\ Element\ A\ {\isasymtimes}\ Element\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}{\kern0pt}types\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlambda}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}\ b{\isadigit{1}}{\isasymrangle}\ {\isasymlangle}a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ b{\isadigit{2}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlangle}add\ MA\ a{\isadigit{1}}\ a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ add\ MB\ b{\isadigit{1}}\ b{\isadigit{2}}{\isasymrangle}\isanewline
\ \ \ \ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}cs\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}cs\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}derivation{\isacharunderscore}{\kern0pt}depth{\isacharequal}{\kern0pt}{\isadigit{8}}{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ lambda{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}contravariant{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ {\isacharquery}{\kern0pt}A{\isacharequal}{\kern0pt}{\isachardoublequoteopen}Element\ A\ {\isasymtimes}\ Element\ B{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ uncurry{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}typeI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ lambda{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}contravariant{\isacharunderscore}{\kern0pt}dom{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ {\isacharquery}{\kern0pt}A{\isacharequal}{\kern0pt}{\isachardoublequoteopen}Element\ A\ {\isasymtimes}\ Element\ B{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ uncurry{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Dep{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}typeI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp{\isacharunderscore}{\kern0pt}all\ only{\isacharcolon}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlambda}{\isasymlangle}a{\isadigit{1}}{\isacharcomma}{\kern0pt}\ b{\isadigit{1}}{\isasymrangle}\ {\isasymlangle}a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ b{\isadigit{2}}{\isasymrangle}\ {\isasymin}\ A\ {\isasymtimes}\ B{\isachardot}{\kern0pt}\ {\isasymlangle}add\ MA\ a{\isadigit{1}}\ a{\isadigit{2}}{\isacharcomma}{\kern0pt}\ add\ MB\ b{\isadigit{1}}\ b{\isadigit{2}}{\isasymrangle}\isanewline
\ \ \ \ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}s\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}\ {\isasymrightarrow}s\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ Dep{\isacharunderscore}{\kern0pt}Function{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}CDep{\isacharunderscore}{\kern0pt}Function\ CDep{\isacharunderscore}{\kern0pt}Function{\isacharunderscore}{\kern0pt}covariant{\isacharunderscore}{\kern0pt}codom{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}M\ {\isacharcolon}{\kern0pt}\ Add\ {\isacharparenleft}{\kern0pt}Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isanewline
\ \ \ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ AddI{\isacharcomma}{\kern0pt}\ subst\ Monoid{\isacharunderscore}{\kern0pt}pair{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\ fact\isanewline
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}add\ {\isacharquery}{\kern0pt}M\ {\isacharparenleft}{\kern0pt}zero\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}add\ {\isacharquery}{\kern0pt}M\ x\ {\isacharparenleft}{\kern0pt}zero\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}def\ zero{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ iff{\isacharcolon}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ y\ z\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}z\ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}add\ {\isacharquery}{\kern0pt}M\ {\isacharparenleft}{\kern0pt}add\ {\isacharquery}{\kern0pt}M\ x\ y{\isacharparenright}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ add\ {\isacharquery}{\kern0pt}M\ x\ {\isacharparenleft}{\kern0pt}add\ {\isacharquery}{\kern0pt}M\ y\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}x\ {\isacharcolon}{\kern0pt}\ Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ Monoid{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}assoc\isanewline
\isacommand{oops}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}instance{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}MA\ {\isacharcolon}{\kern0pt}\ Zero\ A\ {\isasymLongrightarrow}\ MB\ {\isacharcolon}{\kern0pt}\ Zero\ B\ {\isasymLongrightarrow}\ Zero{\isacharunderscore}{\kern0pt}pair\ MA\ MB\ {\isacharcolon}{\kern0pt}\ Zero\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ discharge{\isacharunderscore}{\kern0pt}types%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}instance{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}MA\ {\isacharcolon}{\kern0pt}\ Add\ {\isacharparenleft}{\kern0pt}Element\ A{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ MB\ {\isacharcolon}{\kern0pt}\ Add\ {\isacharparenleft}{\kern0pt}Element\ B{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ Add{\isacharunderscore}{\kern0pt}pair\ A\ B\ MA\ MB\ {\isacharcolon}{\kern0pt}\ Add\ {\isacharparenleft}{\kern0pt}Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ discharge{\isacharunderscore}{\kern0pt}types%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}instance{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}MA\ {\isacharcolon}{\kern0pt}\ Monoid\ {\isacharparenleft}{\kern0pt}Element\ A{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ MB\ {\isacharcolon}{\kern0pt}\ Monoid\ {\isacharparenleft}{\kern0pt}Element\ B{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ Monoid{\isacharunderscore}{\kern0pt}pair\ A\ B\ MA\ MB\ {\isacharcolon}{\kern0pt}\ Monoid\ {\isacharparenleft}{\kern0pt}Element\ {\isacharparenleft}{\kern0pt}A\ {\isasymtimes}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{oops}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Extension to groups%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}typeclass{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Group\ A\ {\isasymequiv}\ Monoid\ A\ {\isacharampersand}{\kern0pt}\ Inv\ A\ {\isacharampersand}{\kern0pt}\isanewline
\ \ type\ {\isacharparenleft}{\kern0pt}{\isasymlambda}G{\isachardot}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isacharcolon}{\kern0pt}\ A{\isachardot}{\kern0pt}\ add\ G\ x\ {\isacharparenleft}{\kern0pt}inv\ G\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ zero\ G{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isacharcolon}{\kern0pt}\ A{\isachardot}{\kern0pt}\ add\ G\ {\isacharparenleft}{\kern0pt}inv\ G\ x{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ zero\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ GroupI\ {\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}intro{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}G\ {\isacharcolon}{\kern0pt}\ Monoid\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}G\ {\isacharcolon}{\kern0pt}\ Inv\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ add\ G\ x\ {\isacharparenleft}{\kern0pt}inv\ G\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ zero\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ add\ G\ {\isacharparenleft}{\kern0pt}inv\ G\ x{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ zero\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}G\ {\isacharcolon}{\kern0pt}\ Group\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Group{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Int{\isacharunderscore}{\kern0pt}typeI\ has{\isacharunderscore}{\kern0pt}typeI{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Group{\isacharunderscore}{\kern0pt}Monoid\ {\isacharbrackleft}{\kern0pt}derive{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}G\ {\isacharcolon}{\kern0pt}\ Group\ A\ {\isasymLongrightarrow}\ G\ {\isacharcolon}{\kern0pt}\ Monoid\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Group{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}drule\ Int{\isacharunderscore}{\kern0pt}typeD{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}typeclass{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Comm{\isacharunderscore}{\kern0pt}Group\ A\ {\isasymequiv}\ Group\ A\ {\isacharampersand}{\kern0pt}\isanewline
\ \ type\ {\isacharparenleft}{\kern0pt}{\isasymlambda}G{\isachardot}{\kern0pt}\ {\isasymforall}a\ b\ {\isacharcolon}{\kern0pt}\ A{\isachardot}{\kern0pt}\ add\ G\ a\ b\ {\isacharequal}{\kern0pt}\ add\ G\ b\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Comm{\isacharunderscore}{\kern0pt}GroupI\ {\isacharbrackleft}{\kern0pt}type{\isacharunderscore}{\kern0pt}intro{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}G\ {\isacharcolon}{\kern0pt}\ Group\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ y\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ add\ G\ x\ y\ {\isacharequal}{\kern0pt}\ add\ G\ y\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}G\ {\isacharcolon}{\kern0pt}\ Comm{\isacharunderscore}{\kern0pt}Group\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Comm{\isacharunderscore}{\kern0pt}Group{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Int{\isacharunderscore}{\kern0pt}typeI\ has{\isacharunderscore}{\kern0pt}typeI{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ \isakeyword{shows}\ Comm{\isacharunderscore}{\kern0pt}Group{\isacharunderscore}{\kern0pt}Group\ {\isacharbrackleft}{\kern0pt}derive{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}G\ {\isacharcolon}{\kern0pt}\ Comm{\isacharunderscore}{\kern0pt}Group\ A\ {\isasymLongrightarrow}\ G\ {\isacharcolon}{\kern0pt}\ Group\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Comm{\isacharunderscore}{\kern0pt}Group{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}drule\ Int{\isacharunderscore}{\kern0pt}typeD{\isadigit{1}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ \isakeyword{shows}\ Comm{\isacharunderscore}{\kern0pt}Group{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}comm{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}{\kern0pt}\ {\isasymlbrakk}G\ {\isacharcolon}{\kern0pt}\ Comm{\isacharunderscore}{\kern0pt}Group\ A{\isacharsemicolon}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ y\ {\isacharcolon}{\kern0pt}\ A{\isasymrbrakk}\ {\isasymLongrightarrow}\ add\ G\ x\ y\ {\isacharequal}{\kern0pt}\ add\ G\ y\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Comm{\isacharunderscore}{\kern0pt}Group{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ dest{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}typeD{\isadigit{2}}\ has{\isacharunderscore}{\kern0pt}typeD{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Multiplicative monoids%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This is just a copy of the additive monoid structure above and should be
automatically generated in the future, or be put in a unified framework.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}typeclass{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Mul{\isacharunderscore}{\kern0pt}Monoid\ A\ {\isasymequiv}\ One\ A\ {\isacharampersand}{\kern0pt}\ Mul\ A\ {\isacharampersand}{\kern0pt}\isanewline
\ \ type\ {\isacharparenleft}{\kern0pt}{\isasymlambda}M{\isachardot}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isacharcolon}{\kern0pt}\ A{\isachardot}{\kern0pt}\ mul\ M\ {\isacharparenleft}{\kern0pt}one\ M{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x\ {\isasymand}\ mul\ M\ x\ {\isacharparenleft}{\kern0pt}one\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ y\ z\ {\isacharcolon}{\kern0pt}\ A{\isachardot}{\kern0pt}\ mul\ M\ {\isacharparenleft}{\kern0pt}mul\ M\ x\ y{\isacharparenright}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ mul\ M\ x\ {\isacharparenleft}{\kern0pt}mul\ M\ y\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Mul{\isacharunderscore}{\kern0pt}MonoidI{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ One\ A{\isachardoublequoteclose}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Mul\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ mul\ M\ {\isacharparenleft}{\kern0pt}one\ M{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ mul\ M\ x\ {\isacharparenleft}{\kern0pt}one\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}x\ y\ z{\isachardot}{\kern0pt}\ {\isasymlbrakk}x\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ y\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ z\ {\isacharcolon}{\kern0pt}\ A{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ mul\ M\ {\isacharparenleft}{\kern0pt}mul\ M\ x\ y{\isacharparenright}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ mul\ M\ x\ {\isacharparenleft}{\kern0pt}mul\ M\ y\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Mul{\isacharunderscore}{\kern0pt}Monoid\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Mul{\isacharunderscore}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ Int{\isacharunderscore}{\kern0pt}typeI\ has{\isacharunderscore}{\kern0pt}typeI{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\isanewline
\ \ \isakeyword{shows}\ Mul{\isacharunderscore}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}One\ {\isacharbrackleft}{\kern0pt}derive{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Mul{\isacharunderscore}{\kern0pt}Monoid\ A\ {\isasymLongrightarrow}\ M\ {\isacharcolon}{\kern0pt}\ One\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Mul{\isacharunderscore}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}Mul\ {\isacharbrackleft}{\kern0pt}derive{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}M\ {\isacharcolon}{\kern0pt}\ Mul{\isacharunderscore}{\kern0pt}Monoid\ A\ {\isasymLongrightarrow}\ M\ {\isacharcolon}{\kern0pt}\ Mul\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Mul{\isacharunderscore}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}mul{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ M\ {\isacharcolon}{\kern0pt}\ Mul{\isacharunderscore}{\kern0pt}Monoid\ A\ {\isasymLongrightarrow}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ mul\ M\ {\isacharparenleft}{\kern0pt}one\ M{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Mul{\isacharunderscore}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}mul{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}eq\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}{\kern0pt}\ M\ {\isacharcolon}{\kern0pt}\ Mul{\isacharunderscore}{\kern0pt}Monoid\ A\ {\isasymLongrightarrow}\ x\ {\isacharcolon}{\kern0pt}\ A\ {\isasymLongrightarrow}\ mul\ M\ x\ {\isacharparenleft}{\kern0pt}one\ M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ Mul{\isacharunderscore}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}mul{\isacharunderscore}{\kern0pt}assoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x\ y\ z{\isachardot}{\kern0pt}\ {\isasymlbrakk}M\ {\isacharcolon}{\kern0pt}\ Mul{\isacharunderscore}{\kern0pt}Monoid\ A{\isacharsemicolon}{\kern0pt}\ x\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ y\ {\isacharcolon}{\kern0pt}\ A{\isacharsemicolon}{\kern0pt}\ z\ {\isacharcolon}{\kern0pt}\ A{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ mul\ M\ {\isacharparenleft}{\kern0pt}mul\ M\ x\ y{\isacharparenright}{\kern0pt}\ z\ {\isacharequal}{\kern0pt}\ mul\ M\ x\ {\isacharparenleft}{\kern0pt}mul\ M\ y\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Mul{\isacharunderscore}{\kern0pt}Monoid{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ {\isadigit{7}}\ {\isadigit{0}}\ dest{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ Int{\isacharunderscore}{\kern0pt}typeD{\isadigit{1}}\ Int{\isacharunderscore}{\kern0pt}typeD{\isadigit{2}}\ has{\isacharunderscore}{\kern0pt}typeD{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/github/Isabelle-Set/Isabelle_Set/Monoids.thy%:%
%:%10=1%:%
%:%11=2%:%
%:%13=4%:%
%:%29=5%:%
%:%30=5%:%
%:%31=6%:%
%:%32=7%:%
%:%41=8%:%
%:%42=9%:%
%:%43=10%:%
%:%44=11%:%
%:%45=12%:%
%:%49=14%:%
%:%50=15%:%
%:%52=17%:%
%:%53=17%:%
%:%58=22%:%
%:%62=38%:%
%:%64=40%:%
%:%65=40%:%
%:%66=41%:%
%:%67=42%:%
%:%68=43%:%
%:%69=44%:%
%:%70=45%:%
%:%71=46%:%
%:%74=47%:%
%:%78=47%:%
%:%79=47%:%
%:%80=48%:%
%:%81=48%:%
%:%90=50%:%
%:%91=51%:%
%:%93=53%:%
%:%94=53%:%
%:%95=54%:%
%:%96=55%:%
%:%97=56%:%
%:%98=57%:%
%:%99=58%:%
%:%100=59%:%
%:%101=60%:%
%:%102=61%:%
%:%103=62%:%
%:%104=63%:%
%:%107=64%:%
%:%111=64%:%
%:%112=64%:%
%:%113=64%:%
%:%127=67%:%
%:%139=69%:%
%:%140=70%:%
%:%141=71%:%
%:%142=72%:%
%:%144=74%:%
%:%145=74%:%
%:%146=75%:%
%:%147=76%:%
%:%148=77%:%
%:%149=77%:%
%:%152=78%:%
%:%156=78%:%
%:%157=78%:%
%:%158=78%:%
%:%163=78%:%
%:%166=79%:%
%:%167=80%:%
%:%168=80%:%
%:%171=81%:%
%:%175=81%:%
%:%176=81%:%
%:%177=81%:%
%:%182=81%:%
%:%185=82%:%
%:%186=83%:%
%:%187=83%:%
%:%190=84%:%
%:%194=84%:%
%:%195=84%:%
%:%200=84%:%
%:%203=85%:%
%:%204=86%:%
%:%205=86%:%
%:%207=88%:%
%:%208=89%:%
%:%209=90%:%
%:%210=91%:%
%:%211=91%:%
%:%214=92%:%
%:%218=92%:%
%:%219=92%:%
%:%220=92%:%
%:%225=92%:%
%:%228=93%:%
%:%229=94%:%
%:%230=94%:%
%:%231=95%:%
%:%232=96%:%
%:%235=97%:%
%:%239=97%:%
%:%240=97%:%
%:%241=97%:%
%:%246=97%:%
%:%249=98%:%
%:%250=99%:%
%:%251=100%:%
%:%252=100%:%
%:%253=101%:%
%:%254=102%:%
%:%261=103%:%
%:%262=103%:%
%:%263=104%:%
%:%264=104%:%
%:%265=104%:%
%:%266=105%:%
%:%267=105%:%
%:%268=106%:%
%:%269=106%:%
%:%270=106%:%
%:%271=107%:%
%:%272=107%:%
%:%273=108%:%
%:%274=109%:%
%:%275=109%:%
%:%276=109%:%
%:%277=110%:%
%:%278=110%:%
%:%279=110%:%
%:%280=111%:%
%:%290=113%:%
%:%291=114%:%
%:%293=116%:%
%:%294=116%:%
%:%297=119%:%
%:%298=120%:%
%:%299=121%:%
%:%300=121%:%
%:%301=122%:%
%:%304=123%:%
%:%308=123%:%
%:%309=123%:%
%:%310=123%:%
%:%315=123%:%
%:%318=124%:%
%:%319=125%:%
%:%320=125%:%
%:%321=126%:%
%:%322=127%:%
%:%323=128%:%
%:%324=129%:%
%:%325=130%:%
%:%328=131%:%
%:%332=131%:%
%:%333=131%:%
%:%334=131%:%
%:%343=133%:%
%:%344=134%:%
%:%346=136%:%
%:%347=136%:%
%:%348=137%:%
%:%349=138%:%
%:%356=139%:%
%:%357=139%:%
%:%358=140%:%
%:%359=140%:%
%:%360=140%:%
%:%361=141%:%
%:%362=141%:%
%:%363=142%:%
%:%364=142%:%
%:%365=143%:%
%:%366=143%:%
%:%367=144%:%
%:%368=144%:%
%:%369=145%:%
%:%370=145%:%
%:%371=146%:%
%:%372=146%:%
%:%373=147%:%
%:%374=148%:%
%:%375=148%:%
%:%376=149%:%
%:%377=149%:%
%:%378=150%:%
%:%379=150%:%
%:%380=151%:%
%:%381=151%:%
%:%382=152%:%
%:%383=152%:%
%:%384=153%:%
%:%385=153%:%
%:%386=154%:%
%:%387=154%:%
%:%388=155%:%
%:%389=155%:%
%:%390=156%:%
%:%391=156%:%
%:%392=157%:%
%:%393=157%:%
%:%394=158%:%
%:%395=158%:%
%:%396=159%:%
%:%397=159%:%
%:%398=159%:%
%:%399=160%:%
%:%400=161%:%
%:%401=161%:%
%:%402=162%:%
%:%403=162%:%
%:%404=163%:%
%:%405=164%:%
%:%406=165%:%
%:%407=165%:%
%:%408=166%:%
%:%409=167%:%
%:%410=167%:%
%:%411=167%:%
%:%412=168%:%
%:%413=168%:%
%:%414=168%:%
%:%415=169%:%
%:%416=169%:%
%:%417=169%:%
%:%418=170%:%
%:%419=171%:%
%:%420=171%:%
%:%421=171%:%
%:%422=172%:%
%:%423=172%:%
%:%424=172%:%
%:%425=173%:%
%:%426=173%:%
%:%427=173%:%
%:%428=174%:%
%:%434=174%:%
%:%437=175%:%
%:%438=176%:%
%:%439=176%:%
%:%440=177%:%
%:%443=178%:%
%:%447=178%:%
%:%448=178%:%
%:%453=178%:%
%:%456=179%:%
%:%457=180%:%
%:%458=180%:%
%:%459=181%:%
%:%460=182%:%
%:%463=183%:%
%:%467=183%:%
%:%468=183%:%
%:%473=183%:%
%:%476=184%:%
%:%477=185%:%
%:%478=185%:%
%:%479=186%:%
%:%480=187%:%
%:%487=188%:%
%:%502=216%:%
%:%512=218%:%
%:%513=218%:%
%:%516=221%:%
%:%517=222%:%
%:%518=223%:%
%:%519=223%:%
%:%520=224%:%
%:%521=225%:%
%:%522=226%:%
%:%523=227%:%
%:%526=228%:%
%:%530=228%:%
%:%531=228%:%
%:%532=229%:%
%:%533=229%:%
%:%538=229%:%
%:%541=230%:%
%:%542=231%:%
%:%543=231%:%
%:%546=232%:%
%:%550=232%:%
%:%551=232%:%
%:%552=232%:%
%:%557=232%:%
%:%560=233%:%
%:%561=234%:%
%:%562=234%:%
%:%563=235%:%
%:%564=236%:%
%:%565=237%:%
%:%566=237%:%
%:%567=238%:%
%:%568=239%:%
%:%569=240%:%
%:%572=241%:%
%:%576=241%:%
%:%577=241%:%
%:%578=242%:%
%:%579=242%:%
%:%584=242%:%
%:%587=243%:%
%:%588=244%:%
%:%589=244%:%
%:%592=245%:%
%:%596=245%:%
%:%597=245%:%
%:%598=245%:%
%:%603=245%:%
%:%606=246%:%
%:%607=247%:%
%:%608=247%:%
%:%609=248%:%
%:%612=249%:%
%:%616=249%:%
%:%617=249%:%
%:%618=249%:%
%:%632=252%:%
%:%644=254%:%
%:%645=255%:%
%:%647=257%:%
%:%648=257%:%
%:%651=260%:%
%:%652=261%:%
%:%653=262%:%
%:%654=262%:%
%:%655=263%:%
%:%656=264%:%
%:%657=265%:%
%:%658=266%:%
%:%659=267%:%
%:%660=268%:%
%:%663=269%:%
%:%667=269%:%
%:%668=269%:%
%:%669=269%:%
%:%674=269%:%
%:%677=270%:%
%:%678=271%:%
%:%679=271%:%
%:%680=272%:%
%:%681=273%:%
%:%682=274%:%
%:%683=275%:%
%:%684=276%:%
%:%685=277%:%
%:%686=278%:%
%:%687=279%:%
%:%688=280%:%
%:%689=281%:%
%:%692=282%:%
%:%696=282%:%
%:%697=282%:%
%:%698=282%:%
%:%703=282%:%
%:%706=283%:%
%:%709=284%:%
%:%714=285%:%
